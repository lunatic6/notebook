# 第1章 Kafka概述

## 1.1 定义

​	Kafka是一个<font color=Red>分布式</font>的基于<font color=Red>发布/订阅模式</font>的<font color=Red>消息队列</font>font>，主要应用于大数据实时处理领域。

## 1.2 消息队列

### 1.1.1 MQ传统应用场景之异步处理

![MQ场景之异步处理.png](D:\Desktop\markdown\尚硅谷Kafka\MQ场景之异步处理.png)

### 1.1.2 消息队列的好处

1. **解耦：**允许独立的扩展或修改两边的处理过程，只要确保它们遵守同样的接口约束。

2. **可恢复性：**系统一部分组件失效，不会影响整个系统；消息队列降低了进程间的耦合度，因此即使一个处理消息的进程挂掉，加入队列中的消息仍然可以在系统恢复后被处理。

   例如：A和B通信，B挂机了，A继续向消息队列添加数据，等到B恢复之后去MQ中提取信息处理即可。

3. **缓冲：**有助于控制和优化数据流经系统的速度，解决生产和消费信息处理速度不一致的情况。更多的是解决生产大于消费的情况。

4. **灵活性和峰值处理能力：**访问量剧增时，应用仍需继续发挥作用，但是突发流量并不常见。如果以能处理这类峰值访问为标准，投入资源随时待命无疑是巨大的浪费。使用消息队列能够使组件顶住突发的访问压力，而不会因为突发的超负荷请求而完全崩溃。举例：因为可以动态的添加中间件。

5. **异步通信：**很多时候，用户不想也不需要立即处理小心。消息队列提供异步处理机制，允许用户把一个消息放入队列，但并不立即处理。想放入队列多少消息就放多少，需要的时候再去处理。

### 1.1.3 消息队列的两种模式

1. 点对点模式（**1对1**，消费者主动拉取数据，消息收到后清除）
   - 生产者生产消息发送到Queue中，然后消费者从Queue中取出并消费消息。消息被消费后，Queue中不在有存储，因此消费者不可能消费到已经被消费的消息。Queue支持存在多个消费者，但是对于一个消息而言，只有一个消费者可以消费
   - ![image-20210513005620446](D:\Desktop\Markdown\尚硅谷Kafka\点对点模式.png)

2. 发布/订阅模式（**1对多**，消费数据之后，数据不会被清除）

   - 生产者发布消息到topic中，同时有多个消费者订阅该消息。发布到topic的消息，会被所有订阅者消费。
   - ![image-20210513005808601](D:\Desktop\Markdown\尚硅谷Kafka\发布订阅模式.png)

   - 又分为消费者主动拉取，或队列推送两种
   - kafka属于前者
     - 缺点：消费者要一直去询问，是否有新消息
     - 队列推送缺点：消费者消费能力不同，太快了有的消费者会崩；太慢，有些消费者资源浪费
     - **（没讲）channel和sink的通讯？**

## 1.3 Kafka架构

<img src="D:\Desktop\Markdown\尚硅谷Kafka\kafka.png" alt="image-20210513231147310" style="zoom:67%;" />

