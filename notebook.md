# 1. Java基础知识

## 1. 集合

### 1. HashMap

- 默认容量：16

- 最大容量：2^30

- 加载因子：0.75

- 扩容机制：

  - 是Node节点的数量大于**阈值**时才扩容，而不是数组中被占位置的数量
  - 添加后判断，而不是添加前

  

#### 1.7和1.8的区别

1. 底层结构：
   - 1.7 数组+链表
   - 1.8 数组+链表+红黑树
     - 并不是链表长度大于8就转化为红黑树
     - 链表长度大于8，并且当前桶的长度不小于64的时候转化为红黑树
     - 如果链表长度大于8，但桶长度小于64，就扩容一次
2. 数组创建：
   - 1.7 new HashMap的时候创建数组
   - 1.8 第一次put方法的时候创建数组
3. 插入方式：
   - 1.7头插法，resize的时候会死循环
   - 1.8尾插法
4. resize时的方式
   - 1.7中resize的时候，所有Entry重新hash & length - 1
   - 1.8中resize，计算新参与进来的二进制高位是否为1
     - 如果为1，新位置=旧位置+原先的容量
     - 如果为0，新位置=旧位置
5. 1.7底层Entry数组，1.8Node数组





# 2. MySql

## 1. 事务

- 定义：**事务由单独单元的一个或多个SQL语句组成，这个单元中，每个MySQL语句相互依赖的。**整个单独单元是<u>不可分割的整体</u> ，如果单元中某条SQL执行失败或产生错误，整个单元会回滚。所有收到影响的数据返回到事务开始以前的状态；如果单元中所有SQL语句都执行成功，则事务顺利执行。

  

### 1. ACID四大属性

1. **原子性**：事务是一个不可分割的工作单位，事务中操作要么全部执行，要么全部不执行
2. **一致性**：事务执行使数据库从一个一致状态切换到另一个一致状态
3. **隔离性**：一个事务的执行不能被其他事物干扰；一个事务内部的操作和使用的数据对并发的其他事物是隔离的，并发执行的各个事务之前不能相互干扰
4. **持久性**：一个事务一旦提交，对数据库数据的改变是永久的，接下来其他操作和数据库故障对此改变无影响

### 2. 使用过程

```sql
set autocommit=0;

start transaction; // 可选
语句...

commit; 提交事务

rollback;回滚事务
```



### 3. 并发问题与隔离级别

同时运行多个事务，访问**数据库中相同的数据**时，会导致各种并发问题

- **脏读**：两个事务T1,T2，T1读取了T2更新但<font color=red>还没有提交</font>的字段，此时若T2回滚，T1读取的内容就是临时且无效的
- **不可重复读**：两个事务T1,T2，T1读取了一个字段，然后T2<font color=red>更新</font>了该字段后，T1再次读取同一个字段，值就不同了
- **幻读**：两个事务T1,T2，T1从一个表中读取一个字段，然后T2在此表中<font color=red>插入</font>了一些新的行，之后，T1再次读取同一个表，就会多出几行



**数据库事务隔离性**：数据库系统必须具有隔离并发运行各个事务的能力，使它们不会相互影响，避免并发问题



数据库提供了4种**隔离级别**

- **READ UNCOMMITED(读取未提交数据)**：
- **READ COMMITED(读已提交数据)**：
- **REPEATABLE READ(可重复读)**：
- **SERIALIZABLE(串行化)**：

